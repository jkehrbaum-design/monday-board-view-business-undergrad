<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Bachelor’s Programs – Freshman & Average Student</title>

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

  <style>
    :root{
      --bg:#f6f7fb; --card:#ffffff; --text:#1f2430; --muted:#6b7280; --line:#e6e9f0;
      --primary:#1f76ff; --pill:#eef3ff; --pillText:#1f4fbf; --link:#1f76ff; --thead:#f2f4f8;
      --chip:#f4f6fa; --chipText:#49506a; --stickyW:280px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0; background:var(--bg); color:var(--text);
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;}

    .wrap{ max-width:1200px; margin:24px auto; padding:0 20px; }
    .h1{ font-size:28px; font-weight:700; margin:8px 0 4px; }
    .sub{ color:var(--muted); font-size:13px; margin-bottom:18px; }

    /* Sticky filter card */
    .card{
      position:sticky; top:0; z-index:20;
      background:var(--card); border:1px solid var(--line);
      border-radius:10px; padding:14px; margin-bottom:16px;
      box-shadow:0 1px 2px rgba(0,0,0,.03);
    }
    .row{display:flex; gap:10px; flex-wrap:wrap; align-items:flex-end}
    .col{display:flex; flex-direction:column; gap:6px}
    .label{font-size:12px; color:var(--muted)}
    input,select{
      height:36px; padding:0 10px; border:1px solid var(--line);
      border-radius:8px; background:#fff; color:var(--text); min-width:120px;
    }
    .nums{width:110px; text-align:right}
    .btn{
      height:36px; padding:0 14px; border-radius:8px; border:1px solid var(--line);
      background:#fff; cursor:pointer; font-weight:600; display:inline-flex; align-items:center; gap:8px;
    }
    .btn.primary{background:var(--primary);border-color:var(--primary);color:#fff}
    .chips{display:flex; gap:8px; align-items:center; font-size:12px}
    .chip{background:var(--chip); color:var(--chipText); padding:4px 8px; border-radius:999px}
    .muted{color:var(--muted)}
    .spacer{flex:1}
    .toggle{display:inline-flex; align-items:center; gap:6px; font-size:12px; color:#444}

    /* TABLE */
    .tableWrap{ background:var(--card); border:1px solid var(--line); border-radius:10px;
      overflow:auto; position:relative; max-height:75vh; }
    table{border-collapse:separate; border-spacing:0; width:1800px;}
    thead th{
      position:sticky; top:0; background:var(--thead); z-index:5;
      font-size:12px; text-transform:uppercase; letter-spacing:.02em;
      color:#49506a; padding:10px; border-bottom:1px solid var(--line);
      user-select:none; cursor:pointer;
    }
    thead th.sortable::after{ content:" ⇅"; font-size:10px; color:#999; margin-left:4px; }
    thead th.sort-asc::after{ content:" ▲"; }
    thead th.sort-desc::after{ content:" ▼"; }
    tbody td{
      padding:12px 10px; border-top:1px solid var(--line); vertical-align:top; font-size:14px;
      max-width:280px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }
    tbody td.trunc { cursor:pointer; }
    /* Frozen first column */
    .sticky{
      position:sticky; left:0; z-index:6;
      background:#fff; min-width:var(--stickyW); max-width:var(--stickyW);
      box-shadow:1px 0 0 var(--line);
    }
    tbody tr:hover td{background:#fafbff}

    .pill{display:inline-flex; align-items:center; gap:6px; padding:4px 10px;
      border-radius:999px; background:var(--pill); color:var(--pillText); font-size:12px; }
    .link{color:var(--link); text-decoration:none; font-weight:600}
    .mono{font-family: ui-monospace,Menlo,Consolas,monospace; font-size:12px}
    .right{text-align:right}

    /* Full-screen loader */
    #loader{
      position:fixed; inset:0; background:#fff; display:flex; align-items:center; justify-content:center;
      font-size:16px; color:#333; z-index:2000;
    }
    .spinner{
      width:48px; height:48px; border:4px solid #eee; border-top-color:var(--primary);
      border-radius:50%; animation:spin 1s linear infinite; margin-right:12px;
    }
    @keyframes spin{ to{ transform:rotate(360deg); } }

    /* Fixed horizontal scroller */
    #fixedScroller {
      position:fixed; bottom:0; left:0; right:0;
      height:20px; overflow-x:auto; overflow-y:hidden;
      background:#f0f0f0; border-top:1px solid #ddd; z-index:3000;
    }
    #scrollInner { height:1px; }
  </style>
</head>
<body>

<!-- Loader -->
<div id="loader"><div class="spinner"></div>Loading data…</div>

<div class="wrap" id="app" style="display:none">
  <div class="h1">Bachelor’s Programs – Freshman & Average Student</div>
  <div class="sub">The data comes from a secure Netlify function (read-only). The look and feel is inspired by Monday.</div>

  <!-- FILTERS -->
  <div class="card">
    <!-- ... filters unchanged ... -->
  </div>

  <!-- TABLE -->
  <div class="tableWrap" id="tableWrap">
    <table id="tbl">
      <thead>
        <tr>
          <th class="sticky sortable" data-key="name">Name</th>
          <th class="sortable" data-key="state">State</th>
          <th class="sortable" data-key="geo_area">Geographical Area</th>
          <th class="sortable" data-key="major">Bachelor’s Study Areas (B)</th>
          <th data-key="tuition" class="right">Tuition</th>
          <th data-key="room" class="right">Room</th>
          <th data-key="board" class="right">Board</th>
          <th data-key="fees" class="right">Fees</th>
          <th data-key="total" class="right">TOTAL</th>
          <th data-key="toefl_hi" class="right">TOEFL iBT Minimum (Highest Scholarship)</th>
        </tr>
      </thead>
      <tbody id="tbody"></tbody>
    </table>
  </div>
</div>

<!-- Fixed bottom scrollbar -->
<div id="fixedScroller"><div id="scrollInner"></div></div>

<script>
(() => {
  const tableWrap = document.getElementById('tableWrap');
  const fixedScroller = document.getElementById('fixedScroller');
  const scrollInner = document.getElementById('scrollInner');

  // Sync bottom scroller with table
  function syncScroller() {
    scrollInner.style.width = tableWrap.scrollWidth + 'px';
  }
  syncScroller();
  new ResizeObserver(syncScroller).observe(tableWrap);

  fixedScroller.addEventListener('scroll', () => {
    tableWrap.scrollLeft = fixedScroller.scrollLeft;
  });
  tableWrap.addEventListener('scroll', () => {
    fixedScroller.scrollLeft = tableWrap.scrollLeft;
  });
})();
</script>
</body>
</html>
